========================================
           Vulnerability Report
========================================

[CVE ID]
    CVE-2025-1893

[Affected Versions]
    <=v2.7.2

[Description]
    We use one UE and two gNBs to simulate a scenario where the UE switches between the gNBs. The Open5GS core network is built from source using the official tutorial, and two gNBs are started with UERANSIM. The configuration uses the default settings, with only the IP addresses modified, as follows:
    open5gs-gnb.yaml:
	linkIp: 127.0.0.1   # gNB's local IP address for Radio Link Simulation (Usually same with local IP)
	ngapIp: 127.0.0.1   # gNB's local IP address for N2 Interface (Usually same with local IP)
	gtpIp: 127.0.0.1    # gNB's local IP address for N3 Interface (Usually same with local IP)
    open5gs-gnb1.yaml
	linkIp: 127.0.0.2   # gNB's local IP address for Radio Link Simulation (Usually same with local IP)
	ngapIp: 127.0.0.2   # gNB's local IP address for N2 Interface (Usually same with local IP)
	gtpIp: 127.0.0.2    # gNB's local IP address for N3 Interface (Usually same with local IP)

    Since the UE needs to switch between two gNBs, two separate configurations are prepared, namely open5gs-ue0.yaml and open5gs-ue1.yaml. In these configurations, only the gnbSearchList parameter is modified, as follows:
    open5gs-ue0.yaml:
	# List of gNB IP addresses for Radio Link Simulation
	gnbSearchList:
  	     - 127.0.0.1
    open5gs-ue1.yaml:
	# List of gNB IP addresses for Radio Link Simulation
	gnbSearchList:
	     - 127.0.0.2
    Next, run the script to simulate the UE continuously switching between the two gNBs. The AMF will receive a large number of handover requests. After approximately 5-10 minutes, the AMF will crash.
    We suspect that the crash was caused by an unknown state in the state machine within the gmm_state_registration() function, specifically involving the process where the AMF sends a smf-select-data request to the UDM using the OGS_SBI_SERVICE_NAME_NUDM_SDM service.

[Reference Link]
    https://github.com/open5gs/open5gs/issues/3707

[Discovered By]


========================================
