========================================
           Vulnerability Report
========================================

[CVE ID]
    CVE-2025-52322

[Affected Versions]
    <=v2.7.2

[Description]

        In Open5GS v2.7.2 and earlier, the SMF (PGW-C) does not perform a uniqueness check on the requested UE IP (PAA field) when handling a GTP-C Create Session Request message.
    An attacker can forge such a request and set the PAA to the IP address of a legitimate UE that is currently in use.
    The SMF will mistakenly treat it as a valid session request and continue processing, sending a PFCP Session Establishment Request to the UPF (PGW-U).
    As a result, the UPF will create another set of downlink forwarding rules (PDR/FAR) based on the same UE IP address,
    redirecting traffic intended for the legitimate user to an attacker-controlled address.
    This leads to serious session hijacking and denial of service, directly threatening network availability and confidentiality.

        Exploitation requires no authentication and no user interaction.
    As long as an attacker can access the SMF control-plane port (GTP-C, UDP/2123), a single carefully crafted GTP-C Create Session Request can trigger this behavior.
    Public Shodan data shows a large number of GTP devices worldwide with critical ports such as 2152/2123 exposed, indicating real-world risk.

        While adding UE IP conflict detection logic in Open5GS can partially mitigate the issue,
    the vendor-recommended fundamental solution is to deploy secure tunnels for all PFCP and GTP-C signaling trafficâ€”such as IPsec (IKEv2) or TLS/DTLS.
    Network-layer authentication and encryption ensure the legitimacy and integrity of control messages,
    preventing forged requests from reaching the SMF or UPF and thereby blocking this class of attack at its root.
    This vulnerability stems from a control-plane signaling protocol design weakness and, in unencrypted/unsegregated deployments,
    can severely impact the security of the mobile core network.

[Reference Link]
    https://github.com/open5gs/open5gs/discussions/3919

[Discovered By]
    Hao Zheng, Yuanhao Li, Wei Guo,  Qiang Fu, Jiajia Liu

========================================